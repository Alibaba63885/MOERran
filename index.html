<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محمد اویس - ارننگ پلیٹ فارم</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(45deg, #74ebd5, #acb6e5);
            color: #333;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .welcome-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff4b2b, #ffd700);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 30;
        }
        .welcome-page h1 {
            font-size: clamp(40px, 8vw, 60px);
            color: white;
            text-shadow: 4px 4px 12px #000;
        }
        .welcome-page p {
            font-size: clamp(20px, 5vw, 28px);
            color: white;
            margin: 20px 0;
        }
        .welcome-btn {
            background: #28a745;
            color: white;
            padding: 12px 30px;
            margin: 10px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: clamp(16px, 4vw, 20px);
            transition: transform 0.3s;
        }
        .welcome-btn:hover {
            transform: scale(1.1);
        }
        .header {
            background: linear-gradient(45deg, #ff4b2b, #ff6f61);
            padding: 20px;
            color: white;
            width: 100%;
            position: fixed;
            top: 0;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .header h1 {
            margin: 0;
            font-size: clamp(30px, 6vw, 45px);
        }
        .header img#logo, .welcome-page img#welcomeLogo {
            width: clamp(40px, 10vw, 50px);
            height: clamp(40px, 10vw, 50px);
            cursor: pointer;
            margin-right: 20px;
        }
        .main-content {
            max-width: 100%;
            margin: 80px auto 20px;
            padding: 15px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            display: none;
            flex-grow: 1;
        }
        .section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        .section h2 {
            color: #ff4b2b;
            font-size: clamp(24px, 5vw, 28px);
        }
        .earnings-display {
            background: linear-gradient(45deg, #d4edda, #c3e6cb);
            padding: 20px;
            border-radius: 15px;
            font-size: clamp(24px, 5vw, 28px);
            color: #155724;
        }
        .task {
            background: #fff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        .task a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            font-size: clamp(16px, 4vw, 18px);
        }
        .task button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: clamp(14px, 3vw, 16px);
        }
        .task button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .task .cooldown {
            font-size: clamp(8px, 2vw, 10px);
            color: #666;
            position: absolute;
            bottom: 5px;
            right: 5px;
        }
        .rules {
            background: #fff3cd;
            padding: 15px;
            border-radius: 12px;
            text-align: right;
        }
        .rules p {
            color: #d63031;
            font-weight: bold;
            font-size: clamp(14px, 3vw, 16px);
        }
        .admin-message {
            background: linear-gradient(45deg, #ffd700, #ffec80);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            color: #333;
            font-weight: bold;
            position: relative;
        }
        .admin-message button {
            background: #28a745;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 10px;
        }
        .withdraw input, .withdraw select {
            padding: 12px;
            width: 90%;
            margin: 10px 0;
            border-radius: 8px;
            border: 2px solid #ced4da;
            font-size: clamp(14px, 3vw, 16px);
        }
        .withdraw button {
            background: #28a745;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: clamp(16px, 4vw, 18px);
        }
        .auth-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            z-index: 40;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            width: 90%;
            max-width: 400px;
        }
        .auth-popup h3 {
            color: #ff4b2b;
            font-size: clamp(20px, 5vw, 24px);
        }
        .auth-popup input {
            padding: 12px;
            width: 85%;
            margin: 10px 0;
            border-radius: 10px;
            border: 2px solid #ced4da;
            font-size: clamp(14px, 3vw, 16px);
        }
        .auth-popup button {
            background: #ff4b2b;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            font-size: clamp(14px, 3vw, 16px);
        }
        .admin-section {
            display: none;
            width: 100%;
            max-width: 300px;
            height: 100vh;
            background: linear-gradient(135deg, #2c3e50, #1a1a2e);
            padding: 15px;
            border-radius: 0 25px 25px 0;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
            z-index: 40;
            overflow-y: auto;
            position: fixed;
            left: 0;
            top: 0;
        }
        .admin-header {
            background: linear-gradient(45deg, #ff4b2b, #ffd700);
            padding: 15px;
            border-radius: 15px;
            color: white;
            text-align: center;
        }
        .admin-header h2 {
            font-size: clamp(24px, 5vw, 28px);
            margin: 0;
        }
        .admin-container {
            margin: 15px 0;
        }
        .admin-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            margin-bottom: 15px;
            transition: transform 0.3s;
        }
        .admin-card:hover {
            transform: scale(1.03);
        }
        .admin-card h2 {
            color: #ff4b2b;
            font-size: clamp(18px, 4vw, 20px);
            margin-top: 0;
            cursor: pointer;
        }
        .user-list {
            display: none;
            max-height: 200px;
            overflow-y: auto;
            background: #fff;
            border-radius: 10px;
            padding: 10px;
        }
        .user-list p {
            margin: 5px 0;
            padding: 5px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .search-bar {
            padding: 10px;
            width: 90%;
            margin: 10px 0;
            border-radius: 5px;
            border: 2px solid #ffd700;
            font-size: clamp(12px, 3vw, 14px);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: #fff;
            border-radius: 10px;
            overflow: hidden;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
            font-size: clamp(12px, 3vw, 14px);
        }
        th {
            background: #ff4b2b;
            color: white;
        }
        .control-btn {
            background: #28a745;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: clamp(12px, 3vw, 14px);
            transition: background 0.3s;
        }
        .control-btn:hover {
            background: #218838;
        }
        .suspend-btn {
            background: #dc3545;
        }
        .suspend-btn:hover {
            background: #c82333;
        }
        .control-input {
            padding: 10px;
            width: 90%;
            margin: 10px 0;
            border-radius: 5px;
            border: 2px solid #ffd700;
            font-size: clamp(12px, 3vw, 14px);
        }
        .control-panel {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        .logout-btn, .back-btn {
            background: #ff4b2b;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: clamp(14px, 3vw, 16px);
            transition: background 0.3s;
        }
        .logout-btn:hover, .back-btn:hover {
            background: #e03e2d;
        }
        .back-btn {
            background: #3498db;
        }
        .back-btn:hover {
            background: #2c87c2;
        }
        .referral-section {
            background: #e9ecef;
            padding: 15px;
            border-radius: 12px;
        }
        .profile-section {
            cursor: pointer;
            background: #e9ecef;
        }
        .profile-details {
            display: none;
            padding: 15px;
            background: #fff;
            border-radius: 10px;
        }
        .withdraw-history {
            background: #fff;
            padding: 15px;
            border-radius: 12px;
        }
        .complain-box {
            background: #e9ecef;
            padding: 15px;
            border-radius: 12px;
        }
        .complain-box textarea {
            width: 90%;
            padding: 10px;
            border-radius: 5px;
            border: 2px solid #ced4da;
            font-size: clamp(14px, 3vw, 16px);
        }
        .complain-box button {
            background: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: clamp(14px, 3vw, 16px);
        }
        .lion {
            position: absolute;
            top: -50px;
            left: 50%;
            transform: translateX(-50%);
            width: clamp(100px, 20vw, 150px);
            height: clamp(100px, 20vw, 150px);
            background: url('https://cdn.pixabay.com/animation/2023/03/01/11/12/11-12-32-512_512.png') no-repeat center;
            background-size: contain;
            animation: walk 5s infinite linear;
            z-index: 10;
        }
        @keyframes walk {
            0% { transform: translateX(-50%) translateY(0) rotate(0deg); }
            50% { transform: translateX(-50%) translateY(-10px) rotate(5deg); }
            100% { transform: translateX(-50%) translateY(0) rotate(0deg); }
        }
        .butterfly {
            position: absolute;
            top: 10px;
            left: 10px;
            width: clamp(40px, 10vw, 60px);
            height: clamp(40px, 10vw, 60px);
            background: url('https://cdn.pixabay.com/animation/2023/06/13/15/29/15-29-43-209_512.gif') no-repeat center;
            background-size: contain;
            animation: fly 15s infinite;
            z-index: 10;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.3));
        }
        @keyframes fly {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
            20% { transform: translate(200px, 50px) rotate(45deg); opacity: 0.8; }
            40% { transform: translate(100px, 100px) rotate(-30deg); opacity: 0; }
            60% { transform: translate(300px, 20px) rotate(60deg); opacity: 1; }
            80% { transform: translate(50px, 150px) rotate(0deg); opacity: 0.5; }
            100% { transform: translate(0, 0) rotate(0deg); opacity: 1; }
        }
        .old-post-dot {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 10px;
            height: 10px;
            background: #ccc;
            border-radius: 50%;
            cursor: pointer;
            transition: background 0.3s;
        }
        .old-post-dot:hover {
            background: #ff4b2b;
        }
        .info-btn {
            position: absolute;
            top: 5px;
            left: 5px;
            width: 20px;
            height: 20px;
            background: #ff4b2b;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            line-height: 20px;
            transition: transform 0.3s;
        }
        .info-btn:hover {
            transform: scale(1.2);
        }
        .info-text {
            display: none;
            position: absolute;
            top: 30px;
            left: 5px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            z-index: 20;
            text-align: right;
            font-size: clamp(12px, 3vw, 14px);
            color: #333;
            width: 200px;
        }
    </style>
</head>
<body>
    <div class="welcome-page" id="welcomePage">
        <img id="welcomeLogo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8Y2lyY2xlIGN4PSIyNSIgY3k9IjI1IiByPSIyNSIgZmlsbD0idXJsKCNncmFkKSIvPgogIDx0ZXh0IHg9IjEyIiB5PSIzMiIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIj5NTzwvdGV4dD4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZCIgeDE9IjAiIHkxPSIwIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjMzQ5OGRiIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzJkODdjMiIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+Cjwvc3ZnPg==" alt="لوگو">
        <h1>خوش آمدید!</h1>
        <p>محمد اویس ارننگ پلیٹ فارم پر آپ کا شاندار استقبال ہے۔ کامیاب رہنے کی راہ پر گامزن ہو جائیں۔</p>
        <button class="welcome-btn" onclick="showSignup()">اکاؤنٹ بنائیں</button>
        <button class="welcome-btn" onclick="showLogin()">لاگ ان کریں</button>
    </div>

    <div class="auth-popup" id="signupPopup">
        <h3>نیا اکاؤنٹ بنائیں</h3>
        <input type="text" id="signupName" placeholder="اپنا نام درج کریں">
        <input type="password" id="signupPassword" placeholder="پاس ورڈ بنائیں">
        <button onclick="userSignup()">اکاؤنٹ بنائیں</button>
        <button onclick="hidePopup('signupPopup')">بیک</button>
    </div>

    <div class="auth-popup" id="loginPopup">
        <h3>لاگ ان کریں</h3>
        <input type="text" id="loginName" placeholder="اپنا نام درج کریں">
        <input type="password" id="loginPassword" placeholder="پاس ورڈ">
        <button onclick="userLogin()">لاگ ان</button>
        <button onclick="hidePopup('loginPopup')">بیک</button>
    </div>

    <div class="header">
        <img id="logo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8Y2lyY2xlIGN4PSIyNSIgY3k9IjI1IiByPSIyNSIgZmlsbD0idXJsKCNncmFkKSIvPgogIDx0ZXh0IHg9IjEyIiB5PSIzMiIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIj5NTzwvdGV4dD4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZCIgeDE9IjAiIHkxPSIwIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjZmY0YjJiIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI2ZmNmY2MSIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+Cjwvc3ZnPg==" alt="لوگو">
        <h1>محمد اویس - ارننگ پلیٹ فارم</h1>
    </div>
    <div class="main-content" id="mainContent">
        <div class="butterfly"></div>
        <div class="section profile-section" onclick="toggleProfile()">
            <h2 id="profileName">یہاں آپ کا نام</h2>
            <div class="profile-details" id="profileDetails">
                <p>نام: <span id="userName"></span></p>
                <p>یوزر آئی ڈی: <span id="userID"></span></p>
                <p>اکاؤنٹ بنانے کی تاریخ: <span id="accountDate"></span></p>
            </div>
        </div>
        <div class="section earnings-display">
            <h2>آپ کی کل ارننگ: <span id="earnings">0 روپے</span></h2>
        </div>
        <div class="section admin-message" id="adminMessageSection">
            <h2>ایڈمن کا پیغام</h2>
            <p id="adminMessageText">یہاں ایڈمن کا تازہ ترین پیغام دکھائی دے گا۔</p>
            <button id="likeButton" onclick="likeMessage()">لائک کریں</button>
            <span id="likeCount">0</span>
        </div>
        <div class="section tasks" id="tasksSection">
            <button class="info-btn" onclick="toggleInfo('tasksInfo')">?</button>
            <div class="info-text" id="tasksInfo">
                ٹاسکس مکمل کرنے کے لیے: <br>1. ویڈیو لنک پر کلک کریں۔ <br>2. ویڈیو مکمل دیکھیں۔ <br>3. "مکمل کیا" بٹن دبائیں۔ <br>ہر ٹاسک سے کمائیں!
            </div>
            <h2>ٹاسکس مکمل کریں</h2>
            <p>ہر ویڈیو مکمل دیکھیں اور کمائیں!</p>
        </div>
        <div class="section referral-section">
            <h2>دوستوں کو مدعو کریں</h2>
            <p>ہر دوست کے سائن اپ پر 5% بونس ملے گا، اور ان کے ریفرل کا 3% بھی آپ کو ملے گا!</p>
            <input type="text" id="referralLink" readonly>
            <button onclick="copyReferralLink()">لنک کاپی کریں</button>
        </div>
        <div class="section rules" id="rulesSection">
            <h2>رولز</h2>
            <div id="rulesContent"></div>
        </div>
        <div class="section withdraw">
            <button class="info-btn" onclick="toggleInfo('withdrawInfo')">?</button>
            <div class="info-text" id="withdrawInfo">
                ودھ ڈراول کے لیے: <br>1. درست نمبر درج کریں۔ <br>2. ایزی پیسہ یا جیز کیش منتخب کریں۔ <br>3. کم از کم 1000 روپے ہونے چاہئیں۔ <br>درست معلومات سے فوری ادائیگی ملے گی!
            </div>
            <h2>کمائی حاصل کریں</h2>
            <p>کم از کم 1000 روپے کمائیں۔</p>
            <input type="text" id="withdrawNumber" placeholder="اپنا نمبر درج کریں">
            <select id="withdrawMethod">
                <option value="easypaisa">ایزی پیسہ</option>
                <option value="jazzcash">جیز کیش</option>
            </select>
            <button onclick="checkWithdrawal()">درخواست دیں</button>
            <p id="withdrawStatus"></p>
        </div>
        <div class="section withdraw-history">
            <h2>ودھ ڈراول ہسٹری</h2>
            <table id="withdrawHistoryTable">
                <tr><th>تاریخ</th><th>رقم</th><th>اکاؤنٹ/نمبر</th></tr>
            </table>
        </div>
        <div class="section complain-box">
            <h2>شکایت درج کریں</h2>
            <textarea id="complainText" rows="4" placeholder="اپنی شکایت یہاں لکھیں (روزانہ ایک بار)"></textarea>
            <button onclick="submitComplain()">جمع کریں</button>
            <p id="complainStatus"></p>
        </div>
    </div>

    <div class="auth-popup" id="adminLoginPopup">
        <h3>مین ایڈمن لاگ ان</h3>
        <input type="password" id="adminPassword" placeholder="ایڈمن پاس ورڈ">
        <button onclick="mainAdminLogin()">لاگ ان</button>
        <button onclick="hidePopup('adminLoginPopup')">بیک</button>
    </div>

    <div class="admin-section" id="adminSection">
        <div class="butterfly"></div>
        <div class="lion"></div>
        <div class="admin-header">
            <h2>مین ایڈمن روم</h2>
            <p>ہر چیز پر مکمل کنٹرول!</p>
        </div>
        <div class="admin-container">
            <div class="admin-card">
                <h2>روزانہ پیغام</h2>
                <textarea id="adminMessageInput" rows="4" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ffd700;" placeholder="یہاں اپنا پیغام لکھیں..."></textarea>
                <button class="control-btn" onclick="updateAdminMessage()">پیغام اپ ڈیٹ کریں</button>
            </div>
            <div class="admin-card">
                <h2>پرانی پوسٹس</h2>
                <div id="oldPosts"></div>
            </div>
            <div class="admin-card">
                <h2 onclick="toggleUserList()">صارفین کا انتظام</h2>
                <input type="text" class="search-bar" id="userSearch" placeholder="یوزر آئی ڈی سرچ کریں" onkeyup="searchUser()">
                <div class="user-list" id="userList"></div>
            </div>
            <div class="admin-card">
                <h2>ودھ ڈراول درخواستیں</h2>
                <table id="withdrawalsTable">
                    <tr><th>نام</th><th>رقم</th><th>حالت</th><th>کنٹرول</th></tr>
                </table>
            </div>
            <div class="admin-card">
                <h2>ویڈیو لنکس اور قیمت تبدیل کریں</h2>
                <input type="number" class="control-input" id="videoIndex" placeholder="ویڈیو نمبر" min="1">
                <input type="text" class="control-input" id="newVideoLink" placeholder="نیا لنک (خالی چھوڑیں اگر صرف قیمت تبدیل کرنی ہو)">
                <input type="number" class="control-input" id="videoPrice" placeholder="نئی قیمت (روپے)" min="1">
                <button class="control-btn" onclick="changeVideoLink()">تبدیل کریں</button>
            </div>
            <div class="admin-card">
                <h2>رولز تبدیل کریں</h2>
                <textarea id="rulesInput" rows="4" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ffd700;" placeholder="نئے رولز لکھیں..."></textarea>
                <button class="control-btn" onclick="updateRules()">رولز اپ ڈیٹ کریں</button>
            </div>
            <div class="admin-card">
                <h2>شکایات</h2>
                <div id="complainsList"></div>
            </div>
        </div>
        <div class="control-panel">
            <button class="back-btn" onclick="goBack()">بیک</button>
            <button class="logout-btn" onclick="logout()">لاگ آؤٹ</button>
        </div>
    </div>

    <script>
        const mainAdminPassword = "MohammadOwaisAdmin2025!@#$ecure";
        let users = JSON.parse(localStorage.getItem("users")) || {};
        let withdrawals = JSON.parse(localStorage.getItem("withdrawals")) || [];
        let withdrawHistory = JSON.parse(localStorage.getItem("withdrawHistory")) || {};
        let adminMessage = localStorage.getItem("adminMessage") || "یہاں ایڈمن کا تازہ ترین پیغام دکھائی دے گا۔";
        let rules = JSON.parse(localStorage.getItem("rules")) || [
            "ہر ویڈیو مکمل دیکھیں۔",
            "دھوکہ دہی پر اکاؤنٹ معطل ہوگا۔",
            "اپنے اکاؤنٹ کا صحیح نمبر درج کریں تاکہ ودھ ڈراول آسانی سے ہو۔"
        ];
        let currentUser = null;
        let videoLinks = JSON.parse(localStorage.getItem("videoLinks")) || [
            { link: "https://www.youtube.com/watch?v=dQw4w9WgXcQ", price: 10 },
            { link: "https://www.youtube.com/watch?v=3tmd-Claq34", price: 10 },
            { link: "https://www.youtube.com/watch?v=9bZkp7q19f0", price: 10 }
        ];
        let taskCooldowns = JSON.parse(localStorage.getItem("taskCooldowns")) || {};
        let videoTimers = {};
        let likes = JSON.parse(localStorage.getItem("likes")) || { total: 0 };
        let oldPosts = JSON.parse(localStorage.getItem("oldPosts")) || [];
        let complains = JSON.parse(localStorage.getItem("complains")) || {};
        let isAdminLoggedIn = false;
        let tapCount = 0;
        let welcomeTapCount = 0;

        window.onload = function() {
            document.getElementById("welcomePage").style.display = "flex";
            document.getElementById("adminMessageText").innerText = adminMessage;
            document.getElementById("likeCount").innerText = likes.total || 0;
            document.getElementById("likeButton").disabled = currentUser && likes[currentUser] ? true : false;
            loadTasks();
            loadRules();
            validateLocalStorage();
            loadOldPosts();
        };

        document.getElementById('logo').addEventListener('click', function() {
            tapCount++;
            if (tapCount === 5) {
                showAdminLogin();
                tapCount = 0;
            }
        });

        document.getElementById('welcomeLogo').addEventListener('click', function() {
            welcomeTapCount++;
            if (welcomeTapCount === 5) {
                showAdminLogin();
                welcomeTapCount = 0;
            }
        });

        function validateLocalStorage() {
            try {
                localStorage.setItem("test", "test");
                localStorage.removeItem("test");
            } catch (e) {
                alert("براؤزر لوکل اسٹوریج کی اجازت نہیں دیتا۔ براہ کرم سیٹنگز چیک کریں۔");
            }
        }

        function showSignup() {
            document.getElementById("welcomePage").style.display = "none";
            document.getElementById("signupPopup").style.display = "block";
        }

        function showLogin() {
            document.getElementById("welcomePage").style.display = "none";
            document.getElementById("loginPopup").style.display = "block";
        }

        function hidePopup(id) {
            document.getElementById(id).style.display = "none";
            document.getElementById("welcomePage").style.display = "flex";
        }

        function userSignup() {
            const name = document.getElementById("signupName").value.trim();
            const password = document.getElementById("signupPassword").value.trim();
            if (!name || !password) {
                alert("براہ کرم نام اور پاس ورڈ درج کریں!");
                return;
            }
            if (users[name]) {
                alert("یہ نام پہلے سے موجود ہے!");
                return;
            }
            const userID = "UID" + Math.random().toString(36).substr(2, 9);
            const createdDate = new Date().toLocaleString();
            users[name] = {
                password: password,
                earnings: 0,
                tasksCompleted: 0,
                lastTaskTime: 0,
                number: "",
                referrals: 0,
                withdrawalCount: 0,
                userID: userID,
                createdDate: createdDate,
                referrer: null,
                lastComplainDate: null
            };
            localStorage.setItem("users", JSON.stringify(users));
            alert("اکاؤنٹ کامیابی سے بن گیا! اب لاگ ان کریں۔");
            hidePopup("signupPopup");
        }

        function userLogin() {
            const name = document.getElementById("loginName").value.trim();
            const password = document.getElementById("loginPassword").value.trim();
            if (users[name] && users[name].password === password) {
                currentUser = name;
                isAdminLoggedIn = false;
                loadUserData();
                document.getElementById("loginPopup").style.display = "none";
                document.getElementById("mainContent").style.display = "block";
                document.getElementById("adminSection").style.display = "none";
            } else {
                alert("غلط نام یا پاس ورڈ! براہ کرم دوبارہ کوشش کریں۔");
            }
        }

        function loadUserData() {
            if (!currentUser) return;
            const user = users[currentUser];
            document.getElementById("earnings").innerText = user.earnings + " روپے";
            document.getElementById("profileName").innerText = currentUser;
            document.getElementById("userName").innerText = currentUser;
            document.getElementById("userID").innerText = user.userID;
            document.getElementById("accountDate").innerText = user.createdDate;
            document.getElementById("referralLink").value = `https://mohammad-owais-earning.com/?ref=${user.userID}`;
            document.getElementById("adminMessageText").innerText = adminMessage;
            document.getElementById("likeCount").innerText = likes.total || 0;
            document.getElementById("likeButton").disabled = likes[currentUser] || false;
            loadWithdrawHistory();
            loadRules();
        }

        function toggleProfile() {
            const details = document.getElementById("profileDetails");
            details.style.display = details.style.display === "block" ? "none" : "block";
        }

        function loadTasks() {
            const tasksSection = document.getElementById("tasksSection");
            tasksSection.innerHTML = `
                <button class="info-btn" onclick="toggleInfo('tasksInfo')">?</button>
                <div class="info-text" id="tasksInfo">
                    ٹاسکس مکمل کرنے کے لیے: <br>1. ویڈیو لنک پر کلک کریں۔ <br>2. ویڈیو مکمل دیکھیں۔ <br>3. "مکمل کیا" بٹن دبائیں۔ <br>ہر ٹاسک سے کمائیں!
                </div>
                <h2>ٹاسکس مکمل کریں</h2>
                <p>ہر ویڈیو مکمل دیکھیں اور کمائیں!</p>
            `;
            videoLinks.forEach((video, i) => {
                const task = document.createElement("div");
                task.className = "task";
                task.innerHTML = `<p>ویڈیو ${i + 1}: <a href="${video.link}" target="_blank" onclick="startVideoTimer('${i}')">ویڈیو دیکھیں</a> (${video.price} روپے)</p><button onclick="addEarnings(${video.price}, this, ${i})">مکمل کیا</button><span class="cooldown" id="cooldown-${i}"></span>`;
                tasksSection.appendChild(task);
            });
            if (currentUser) updateCooldowns();
        }

        function startVideoTimer(videoIndex) {
            if (!currentUser) return;
            videoTimers[currentUser + videoIndex] = {
                startTime: Date.now(),
                isActive: true
            };
            window.addEventListener('focus', () => checkVideoCompletion(videoIndex));
        }

        function checkVideoCompletion(videoIndex) {
            if (!currentUser) return;
            const timer = videoTimers[currentUser + videoIndex];
            if (timer && timer.isActive) {
                const elapsed = (Date.now() - timer.startTime) / 1000;
                if (elapsed < 300) { // Assuming 5 minutes minimum
                    timer.isActive = false;
                    alert("دھوکہ دہی کا پتہ چلا! ویڈیو مکمل دیکھیں۔");
                }
            }
        }

        function addEarnings(amount, button, videoIndex) {
            if (!currentUser) return;
            const timer = videoTimers[currentUser + videoIndex];
            if (!timer || !timer.isActive || (Date.now() - timer.startTime) / 1000 < 300) {
                alert("دھوکہ دہی کا پتہ چلا! ویڈیو مکمل دیکھیں ورنہ اکاؤنٹ معطل ہو سکتا ہے۔");
                if (confirm("کیا آپ اپنا اکاؤنٹ معطل کروانا چاہتے ہیں؟")) {
                    delete users[currentUser];
                    localStorage.setItem("users", JSON.stringify(users));
                    alert("آپ کا اکاؤنٹ معطل ہو گیا!");
                    location.reload();
                }
                return;
            }
            users[currentUser].earnings += amount;
            if (users[currentUser].referrer) {
                const referrer = users[currentUser].referrer;
                users[referrer].earnings += amount * 0.05; // 5% for direct referral
                if (users[referrer].referrer) {
                    users[users[referrer].referrer].earnings += amount * 0.03; // 3% for second-level referral
                }
            }
            users[currentUser].tasksCompleted += 1;
            document.getElementById("earnings").innerText = users[currentUser].earnings + " روپے";
            button.disabled = true;
            button.innerText = "مکمل ہو گیا";
            if (!taskCooldowns[currentUser]) taskCooldowns[currentUser] = {};
            taskCooldowns[currentUser][videoIndex] = Date.now();
            localStorage.setItem("users", JSON.stringify(users));
            localStorage.setItem("taskCooldowns", JSON.stringify(taskCooldowns));
            alert("مبارک ہو! آپ نے " + amount + " روپے کمائے۔");
            setTimeout(() => {
                button.disabled = false;
                button.innerText = "مکمل کیا";
            }, 30 * 60 * 1000); // 30 منٹ بعد دوبارہ ایکٹیویٹ
            updateCooldowns();
        }

        function updateCooldowns() {
            if (!currentUser) return;
            videoLinks.forEach((_, i) => {
                const cooldownElement = document.getElementById(`cooldown-${i}`);
                const lastTaskTime = taskCooldowns[currentUser]?.[i] || 0;
                const currentTime = Date.now();
                const remaining = 30 * 60 * 1000 - (currentTime - lastTaskTime); // 30 منٹ کول ڈاؤن
                if (remaining > 0) {
                    const minutes = Math.ceil(remaining / 1000 / 60);
                    cooldownElement.innerText = `30 منٹ بعد دوبارہ کوشش کریں (${minutes} منٹ باقی)`;
                    setTimeout(updateCooldowns, 60000);
                } else {
                    cooldownElement.innerText = "";
                    const button = document.querySelectorAll(".task button")[i];
                    if (button) button.disabled = false;
                }
            });
        }

        function checkWithdrawal() {
            if (!currentUser) return;
            const user = users[currentUser];
            if (user.earnings < 1000) {
                alert("کم از کم 1000 روپے کمائیں!");
                return;
            }
            if (user.withdrawalCount === 0 && user.referrals < 3) {
                alert("پہلی ودھ ڈراول کے لیے 3 دوست بنائیں!");
                return;
            }
            const number = document.getElementById("withdrawNumber").value.trim();
            const method = document.getElementById("withdrawMethod").value;
            const amount = user.earnings;
            withdrawals.push({ user: currentUser, number, amount, method, status: "processing" });
            user.number = number;
            if (!withdrawHistory[currentUser]) withdrawHistory[currentUser] = [];
            withdrawHistory[currentUser].push({ date: new Date().toLocaleString(), amount, number });
            localStorage.setItem("withdrawals", JSON.stringify(withdrawals));
            localStorage.setItem("withdrawHistory", JSON.stringify(withdrawHistory));
            alert("درخواست موصول ہوئی!");
            loadWithdrawHistory();
            document.getElementById("withdrawStatus").innerText = "پروسیسنگ جاری ہے...";
        }

        function loadWithdrawHistory() {
            if (!currentUser) return;
            const table = document.getElementById("withdrawHistoryTable");
            table.innerHTML = "<tr><th>تاریخ</th><th>رقم</th><th>اکاؤنٹ/نمبر</th></tr>";
            if (withdrawHistory[currentUser]) {
                withdrawHistory[currentUser].forEach(w => {
                    const row = table.insertRow();
                    row.innerHTML = `<td>${w.date}</td><td>${w.amount} روپے</td><td>${w.number}</td>`;
                });
            }
        }

        function copyReferralLink() {
            if (!currentUser) return;
            const link = document.getElementById("referralLink");
            link.select();
            document.execCommand("copy");
            alert("ریفرل لنک کاپی ہو گیا!");
            const referrer = prompt("ریفرل کا نام درج کریں (اگر کوئی ہو):");
            if (referrer && users[referrer]) {
                users[referrer].referrals += 1;
                users[referrer].earnings += 50;
                users[currentUser].referrer = referrer;
                localStorage.setItem("users", JSON.stringify(users));
                alert(`${referrer} کو 50 روپے بونس مل گیا!`);
            }
        }

        function submitComplain() {
            if (!currentUser) return;
            const user = users[currentUser];
            const complainText = document.getElementById("complainText").value.trim();
            const today = new Date().toDateString();
            if (!complainText) {
                alert("براہ کرم شکایت لکھیں!");
                return;
            }
            if (user.lastComplainDate === today) {
                alert("آپ روزانہ صرف ایک شکایت درج کر سکتے ہیں!");
                return;
            }
            if (!complains[currentUser]) complains[currentUser] = [];
            complains[currentUser].push({ text: complainText, date: new Date().toLocaleString() });
            user.lastComplainDate = today;
            localStorage.setItem("complains", JSON.stringify(complains));
            localStorage.setItem("users", JSON.stringify(users));
            document.getElementById("complainText").value = "";
            document.getElementById("complainStatus").innerText = "شکایت درج ہو گئی!";
            setTimeout(() => document.getElementById("complainStatus").innerText = "", 3000);
        }

        function showAdminLogin() {
            document.getElementById("adminLoginPopup").style.display = "block";
        }

        function mainAdminLogin() {
            const password = document.getElementById("adminPassword").value.trim();
            if (password === mainAdminPassword) {
                isAdminLoggedIn = true;
                document.getElementById("adminLoginPopup").style.display = "none";
                document.getElementById("adminSection").style.display = "block";
                document.getElementById("mainContent").style.display = "none";
                document.getElementById("welcomePage").style.display = "none";
                loadMainAdminData();
            } else {
                alert("غلط پاس ورڈ!");
            }
        }

        function updateAdminMessage() {
            const message = document.getElementById("adminMessageInput").value.trim();
            if (!message) {
                alert("براہ کرم پیغام درج کریں!");
                return;
            }
            const oldPost = { message: adminMessage, likes: likes.total || 0, date: new Date().toLocaleString() };
            oldPosts.unshift(oldPost);
            if (oldPosts.length > 5) oldPosts.pop();
            localStorage.setItem("oldPosts", JSON.stringify(oldPosts));
            adminMessage = message;
            likes = { total: 0 };
            localStorage.setItem("adminMessage", adminMessage);
            localStorage.setItem("likes", JSON.stringify(likes));
            document.getElementById("adminMessageText").innerText = adminMessage;
            document.getElementById("likeCount").innerText = 0;
            document.getElementById("likeButton").disabled = false;
            alert("پیغام کامیابی سے اپ ڈیٹ ہو گیا!");
            loadOldPosts();
        }

        function likeMessage() {
            if (!currentUser || likes[currentUser]) {
                alert("آپ پہلے ہی اس پیغام کو لائک کر چکے ہیں!");
                return;
            }
            likes.total = (likes.total || 0) + 1;
            likes[currentUser] = true;
            document.getElementById("likeCount").innerText = likes.total;
            document.getElementById("likeButton").disabled = true;
            localStorage.setItem("likes", JSON.stringify(likes));
            alert("پیغام لائک ہو گیا!");
        }

        function loadOldPosts() {
            const oldPostsDiv = document.getElementById("oldPosts");
            oldPostsDiv.innerHTML = "";
            if (oldPosts.length > 0) {
                const dot = document.createElement("div");
                dot.className = "old-post-dot";
                dot.onclick = showOldPosts;
                oldPostsDiv.appendChild(dot);
            }
        }

        function showOldPosts() {
            const oldPostsDiv = document.getElementById("oldPosts");
            oldPostsDiv.innerHTML = "";
            oldPosts.forEach((post, i) => {
                const postDiv = document.createElement("div");
                postDiv.innerHTML = `<p>${post.message} (تاریخ: ${post.date}) - لائکس: ${post.likes}</p>`;
                oldPostsDiv.appendChild(postDiv);
            });
        }

        function loadMainAdminData() {
            const withdrawalsTable = document.getElementById("withdrawalsTable");
            document.getElementById("adminMessageInput").value = adminMessage;
            document.getElementById("rulesInput").value = rules.join("\n");
            withdrawalsTable.innerHTML = "<tr><th>نام</th><th>رقم</th><th>حالت</th><th>کنٹرول</th></tr>";
            loadUserList();
            loadComplains();

            withdrawals.forEach((w, i) => {
                const row = withdrawalsTable.insertRow();
                row.innerHTML = `
                    <td>${w.user}</td>
                    <td>${w.amount} روپے</td>
                    <td>${w.status === "processing" ? "پروسیسنگ" : "مکمل"}</td>
                    <td>
                        <button class="control-btn" onclick="approveWithdrawal(${i})" ${w.status === "complete" ? "disabled" : ""}>ادائیگی بھیجیں</button>
                        <button class="control-btn suspend-btn" onclick="rejectWithdrawal(${i})" ${w.status === "complete" ? "disabled" : ""}>مسترد</button>
                    </td>
                `;
            });
        }

        function loadUserList() {
            const userList = document.getElementById("userList");
            userList.innerHTML = "";
            for (let user in users) {
                const userDiv = document.createElement("p");
                userDiv.innerHTML = `${user} - ${users[user].earnings} روپے - ${users[user].referrals} ریفرلز - ${users[user].userID}
                    <button class="control-btn" onclick="payUser('${user}')">ادائیگی</button>
                    <button class="control-btn suspend-btn" onclick="deleteAccount('${user}')">ڈیلیٹ</button>`;
                userList.appendChild(userDiv);
            }
        }

        function toggleUserList() {
            const userList = document.getElementById("userList");
            userList.style.display = userList.style.display === "block" ? "none" : "block";
        }

        function searchUser() {
            const searchValue = document.getElementById("userSearch").value.trim().toLowerCase();
            const userList = document.getElementById("userList");
            userList.innerHTML = "";
            for (let user in users) {
                if (users[user].userID.toLowerCase().includes(searchValue)) {
                    const userDiv = document.createElement("p");
                    userDiv.innerHTML = `${user} - ${users[user].earnings} روپے - ${users[user].referrals} ریفرلز - ${users[user].userID}
                        <button class="control-btn" onclick="payUser('${user}')">ادائیگی</button>
                        <button class="control-btn suspend-btn" onclick="deleteAccount('${user}')">ڈیلیٹ</button>`;
                    userList.appendChild(userDiv);
                }
            }
        }

        function payUser(user) {
            if (confirm(`${user} کو ${users[user].earnings} روپے ادائیگی کرنا چاہتے ہیں؟`)) {
                users[user].earnings = 0;
                localStorage.setItem("users", JSON.stringify(users));
                loadMainAdminData();
                if (currentUser === user) loadUserData();
                alert(`${user} کو ادائیگی کامیابی سے کی گئی۔`);
            }
        }

        function deleteAccount(user) {
            if (confirm(`${user} کا اکاؤنٹ ڈیلیٹ کرنا چاہتے ہیں؟`)) {
                delete users[user];
                delete withdrawHistory[user];
                delete complains[user];
                localStorage.setItem("users", JSON.stringify(users));
                localStorage.setItem("withdrawHistory", JSON.stringify(withdrawHistory));
                localStorage.setItem("complains", JSON.stringify(complains));
                loadMainAdminData();
                alert(`${user} کا اکاؤنٹ ڈیلیٹ ہو گیا۔`);
            }
        }

        function approveWithdrawal(index) {
            const w = withdrawals[index];
            users[w.user].earnings -= w.amount;
            users[w.user].withdrawalCount += 1;
            if (users[w.user].referrer) users[users[w.user].referrer].earnings += w.amount * 0.05;
            withdrawals[index].status = "complete";
            localStorage.setItem("users", JSON.stringify(users));
            localStorage.setItem("withdrawals", JSON.stringify(withdrawals));
            loadMainAdminData();
            if (currentUser === w.user) {
                loadUserData();
                document.getElementById("withdrawStatus").innerText = "";
            }
            alert(`ادائیگی ${w.number} کو بھیج دی گئی۔`);
        }

        function rejectWithdrawal(index) {
            withdrawals.splice(index, 1);
            localStorage.setItem("withdrawals", JSON.stringify(withdrawals));
            loadMainAdminData();
            if (currentUser) document.getElementById("withdrawStatus").innerText = "";
            alert("درخواست مسترد ہو گئی۔");
        }

        function changeVideoLink() {
            const index = parseInt(document.getElementById("videoIndex").value) - 1;
            const newLink = document.getElementById("newVideoLink").value.trim();
            const newPrice = parseInt(document.getElementById("videoPrice").value) || videoLinks[index]?.price;
            if (index >= 0) {
                if (newLink) {
                    if (index < videoLinks.length) {
                        videoLinks[index].link = newLink;
                    } else {
                        videoLinks.push({ link: newLink, price: newPrice || 10 });
                    }
                }
                if (newPrice && index < videoLinks.length) {
                    videoLinks[index].price = newPrice;
                }
                localStorage.setItem("videoLinks", JSON.stringify(videoLinks));
                loadTasks();
                alert(`ویڈیو ${index + 1} تبدیل ہو گئی: ${newLink || videoLinks[index].link} (${videoLinks[index].price} روپے)`);
                document.getElementById("videoIndex").value = "";
                document.getElementById("newVideoLink").value = "";
                document.getElementById("videoPrice").value = "";
            } else {
                alert("غلط ویڈیو نمبر درج کریں!");
            }
        }

        function updateRules() {
            const newRules = document.getElementById("rulesInput").value.trim().split("\n").filter(rule => rule.trim());
            if (newRules.length === 0) {
                alert("براہ کرم کم از کم ایک رول درج کریں!");
                return;
            }
            rules = newRules;
            localStorage.setItem("rules", JSON.stringify(rules));
            loadRules();
            alert("رولز کامیابی سے اپ ڈیٹ ہو گئے!");
        }

        function loadRules() {
            const rulesContent = document.getElementById("rulesContent");
            rulesContent.innerHTML = "";
            rules.forEach(rule => {
                const p = document.createElement("p");
                p.innerText = rule;
                rulesContent.appendChild(p);
            });
        }

        function loadComplains() {
            const complainsList = document.getElementById("complainsList");
            complainsList.innerHTML = "";
            for (let user in complains) {
                complains[user].forEach(c => {
                    const p = document.createElement("p");
                    p.innerHTML = `${user}: ${c.text} (تاریخ: ${c.date})`;
                    complainsList.appendChild(p);
                });
            }
        }

        function logout() {
            isAdminLoggedIn = false;
            document.getElementById("adminSection").style.display = "none";
            document.getElementById("welcomePage").style.display = "flex";
        }

        function goBack() {
            if (isAdminLoggedIn) {
                document.getElementById("adminSection").style.display = "none";
                if (currentUser) {
                    document.getElementById("mainContent").style.display = "block";
                    loadUserData();
                } else {
                    document.getElementById("welcomePage").style.display = "flex";
                }
            }
        }

        function toggleInfo(id) {
            const info = document.getElementById(id);
            info.style.display = info.style.display === "block" ? "none" : "block";
        }
    </script>
</body>
</html>