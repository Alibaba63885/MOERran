<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محمد اویس - ارننگ پلیٹ فارم</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background: linear-gradient(45deg, #74ebd5, #acb6e5);
            color: #333;
            text-align: center;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .welcome-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff4b2b, #ffd700);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 30;
        }
        .welcome-page h1 {
            font-size: clamp(40px, 8vw, 60px);
            color: white;
            text-shadow: 4px 4px 12px #000;
        }
        .welcome-page p {
            font-size: clamp(20px, 5vw, 28px);
            color: white;
            margin: 20px 0;
        }
        .welcome-btn {
            background: #28a745;
            color: white;
            padding: 12px 30px;
            margin: 10px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: clamp(16px, 4vw, 20px);
            transition: transform 0.3s, background 0.3s;
        }
        .welcome-btn:hover {
            transform: scale(1.1);
            background: #218838;
        }
        .header {
            background: linear-gradient(45deg, #ff4b2b, #ff6f61);
            padding: 20px;
            color: white;
            width: 100%;
            position: fixed;
            top: 0;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        .header h1 {
            margin: 0;
            font-size: clamp(24px, 6vw, 36px);
        }
        .header img#logo, .welcome-page img#welcomeLogo {
            width: clamp(40px, 10vw, 50px);
            height: clamp(40px, 10vw, 50px);
            cursor: pointer;
            margin-right: 20px;
            transition: transform 0.3s;
        }
        .header img#logo:hover, .welcome-page img#welcomeLogo:hover {
            transform: rotate(360deg);
        }
        .main-content {
            max-width: 1200px;
            margin: 80px auto 20px;
            padding: 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            display: none;
            flex-grow: 1;
        }
        .section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        .section h2 {
            color: #ff4b2b;
            font-size: clamp(22px, 5vw, 28px);
            margin-bottom: 10px;
        }
        .earnings-display {
            background: linear-gradient(45deg, #d4edda, #c3e6cb);
            padding: 20px;
            border-radius: 15px;
            font-size: clamp(20px, 5vw, 28px);
            color: #155724;
        }
        .task {
            background: #fff;
            padding: 15px;
            margin: 10px 0;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            transition: transform 0.2s;
        }
        .task:hover {
            transform: scale(1.02);
        }
        .task a {
            color: #007bff;
            text-decoration: none;
            font-weight: bold;
            font-size: clamp(16px, 4vw, 18px);
        }
        .task button {
            background: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: clamp(14px, 3vw, 16px);
            transition: background 0.3s;
        }
        .task button:hover:not(:disabled) {
            background: #0056b3;
        }
        .task button:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .task .cooldown {
            font-size: clamp(10px, 2vw, 12px);
            color: #666;
            position: absolute;
            bottom: 5px;
            right: 10px;
        }
        .rules {
            background: #fff3cd;
            padding: 15px;
            border-radius: 12px;
            text-align: right;
        }
        .rules p {
            color: #d63031;
            font-weight: bold;
            font-size: clamp(14px, 3vw, 16px);
            margin: 5px 0;
        }
        .admin-message {
            background: linear-gradient(45deg, #ffd700, #ffec80);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            color: #333;
            font-weight: bold;
            position: relative;
        }
        .admin-message button {
            background: #28a745;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 10px;
            transition: background 0.3s;
        }
        .admin-message button:hover:not(:disabled) {
            background: #218838;
        }
        .withdraw input, .withdraw select {
            padding: 12px;
            width: 100%;
            max-width: 400px;
            margin: 10px auto;
            border-radius: 8px;
            border: 2px solid #ced4da;
            font-size: clamp(14px, 3vw, 16px);
            display: block;
        }
        .withdraw button {
            background: #28a745;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: clamp(16px, 4vw, 18px);
            transition: background 0.3s;
        }
        .withdraw button:hover {
            background: #218838;
        }
        .auth-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
            z-index: 40;
            width: 90%;
            max-width: 400px;
            animation: fadeIn 0.3s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .auth-popup h3 {
            color: #ff4b2b;
            font-size: clamp(20px, 5vw, 24px);
            margin-bottom: 15px;
        }
        .auth-popup input {
            padding: 12px;
            width: 100%;
            margin: 10px 0;
            border-radius: 10px;
            border: 2px solid #ced4da;
            font-size: clamp(14px, 3vw, 16px);
        }
        .auth-popup button {
            background: #ff4b2b;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin: 10px;
            font-size: clamp(14px, 3vw, 16px);
            transition: background 0.3s;
        }
        .auth-popup button:hover {
            background: #e03e2d;
        }
        .admin-section {
            display: none;
            width: 100%;
            max-width: 350px;
            height: 100vh;
            background: linear-gradient(135deg, #2c3e50, #1a1a2e);
            padding: 20px;
            border-radius: 0 25px 25px 0;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
            z-index: 40;
            overflow-y: auto;
            position: fixed;
            left: 0;
            top: 0;
        }
        .admin-header {
            background: linear-gradient(45deg, #ff4b2b, #ffd700);
            padding: 15px;
            border-radius: 15px;
            color: white;
            text-align: center;
        }
        .admin-header h2 {
            font-size: clamp(22px, 5vw, 28px);
            margin: 0;
        }
        .admin-container {
            margin: 20px 0;
        }
        .admin-card {
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            margin-bottom: 15px;
            transition: transform 0.3s;
        }
        .admin-card:hover {
            transform: scale(1.03);
        }
        .admin-card h2 {
            color: #ff4b2b;
            font-size: clamp(18px, 4vw, 20px);
            margin-top: 0;
            cursor: pointer;
        }
        .user-list {
            display: none;
            max-height: 200px;
            overflow-y: auto;
            background: #fff;
            border-radius: 10px;
            padding: 10px;
        }
        .user-list p {
            margin: 5px 0;
            padding: 5px;
            background: #f8f9fa;
            border-radius: 5px;
            font-size: clamp(12px, 3vw, 14px);
        }
        .search-bar {
            padding: 10px;
            width: 100%;
            margin: 10px 0;
            border-radius: 5px;
            border: 2px solid #ffd700;
            font-size: clamp(12px, 3vw, 14px);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            background: #fff;
            border-radius: 10px;
            overflow: hidden;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
            font-size: clamp(12px, 3vw, 14px);
        }
        th {
            background: #ff4b2b;
            color: white;
        }
        .control-btn {
            background: #28a745;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: clamp(12px, 3vw, 14px);
            transition: background 0.3s;
        }
        .control-btn:hover {
            background: #218838;
        }
        .suspend-btn {
            background: #dc3545;
        }
        .suspend-btn:hover {
            background: #c82333;
        }
        .control-input {
            padding: 10px;
            width: 100%;
            margin: 10px 0;
            border-radius: 5px;
            border: 2px solid #ffd700;
            font-size: clamp(12px, 3vw, 14px);
        }
        .control-panel {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }
        .logout-btn, .back-btn {
            background: #ff4b2b;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: clamp(14px, 3vw, 16px);
            transition: background 0.3s;
        }
        .logout-btn:hover, .back-btn:hover {
            background: #e03e2d;
        }
        .back-btn {
            background: #3498db;
        }
        .back-btn:hover {
            background: #2c87c2;
        }
        .referral-section {
            background: #e9ecef;
            padding: 15px;
            border-radius: 12px;
        }
        .profile-section {
            cursor: pointer;
            background: #e9ecef;
            transition: background 0.3s;
        }
        .profile-section:hover {
            background: #dfe2e6;
        }
        .profile-details {
            display: none;
            padding: 15px;
            background: #fff;
            border-radius: 10px;
        }
        .withdraw-history {
            background: #fff;
            padding: 15px;
            border-radius: 12px;
        }
        .complain-box {
            background: #e9ecef;
            padding: 15px;
            border-radius: 12px;
        }
        .complain-box textarea {
            width: 100%;
            max-width: 400px;
            padding: 10px;
            border-radius: 5px;
            border: 2px solid #ced4da;
            font-size: clamp(14px, 3vw, 16px);
            resize: vertical;
        }
        .complain-box button {
            background: #28a745;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: clamp(14px, 3vw, 16px);
            transition: background 0.3s;
        }
        .complain-box button:hover {
            background: #218838;
        }
        /* میڈیا کوئریز برائے ریسپانسیو ڈیزائن */
        @media (max-width: 768px) {
            .main-content {
                margin: 70px 10px 10px;
                padding: 15px;
            }
            .header h1 {
                font-size: 24px;
            }
            .welcome-btn, .task button, .withdraw button, .auth-popup button {
                padding: 10px 20px;
                font-size: 16px;
            }
            .task {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            .admin-section {
                max-width: 100%;
                border-radius: 0;
            }
        }
        @media (max-width: 480px) {
            .header h1 {
                font-size: 20px;
            }
            .welcome-btn, .task button, .withdraw button, .auth-popup button {
                padding: 8px 15px;
                font-size: 14px;
            }
            .section h2 {
                font-size: 20px;
            }
        }
    </style>
    <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>
    <div class="welcome-page" id="welcomePage">
        <img id="welcomeLogo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8Y2lyY2xlIGN4PSIyNSIgY3k9IjI1IiByPSIyNSIgZmlsbD0idXJsKCNncmFkKSIvPgogIDx0ZXh0IHg9IjEyIiB5PSIzMiIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIj5NTzwvdGV4dD4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZCIgeDE9IjAiIHkxPSIwIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjMzQ5OGRiIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzJkODdjMiIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+Cjwvc3ZnPg==" alt="لوگو">
        <h1>خوش آمدید!</h1>
        <p>محمد اویس ارننگ پلیٹ فارم پر آپ کا شاندار استقبال ہے۔ کامیابی کی راہ پر گامزن ہوں!</p>
        <button class="welcome-btn" onclick="showSignup()">اکاؤنٹ بنائیں</button>
        <button class="welcome-btn" onclick="showLogin()">لاگ ان کریں</button>
    </div>

    <div class="auth-popup" id="signupPopup">
        <h3>نیا اکاؤنٹ بنائیں</h3>
        <input type="text" id="signupName" placeholder="اپنا نام درج کریں" required>
        <input type="password" id="signupPassword" placeholder="پاس ورڈ بنائیں" required>
        <button onclick="userSignup()">اکاؤنٹ بنائیں</button>
        <button onclick="hidePopup('signupPopup')">بیک</button>
    </div>

    <div class="auth-popup" id="loginPopup">
        <h3>لاگ ان کریں</h3>
        <input type="text" id="loginName" placeholder="اپنا نام درج کریں" required>
        <input type="password" id="loginPassword" placeholder="پاس ورڈ" required>
        <button onclick="userLogin()">لاگ ان</button>
        <button onclick="hidePopup('loginPopup')">بیک</button>
    </div>

    <div class="header">
        <img id="logo" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8Y2lyY2xlIGN4PSIyNSIgY3k9IjI1IiByPSIyNSIgZmlsbD0idXJsKCNncmFkKSIvPgogIDx0ZXh0IHg9IjEyIiB5PSIzMiIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IndoaXRlIj5NTzwvdGV4dD4KICA8ZGVmcz4KICAgIDxsaW5lYXJHcmFkaWVudCBpZD0iZ3JhZCIgeDE9IjAiIHkxPSIwIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPgogICAgICA8c3RvcCBvZmZzZXQ9IjAlIiBzdG9wLWNvbG9yPSIjZmY0YjJiIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iI2ZmNmY2MSIvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICA8L2RlZnM+Cjwvc3ZnPg==" alt="لوگو">
        <h1>محمد اویس - ارننگ پلیٹ فارم</h1>
    </div>

    <div class="main-content" id="mainContent">
        <div class="section profile-section" onclick="toggleProfile()">
            <h2 id="profileName">یہاں آپ کا نام</h2>
            <div class="profile-details" id="profileDetails">
                <p>نام: <span id="userName"></span></p>
                <p>یوزر آئی ڈی: <span id="userID"></span></p>
                <p>اکاؤنٹ بنانے کی تاریخ: <span id="accountDate"></span></p>
                <p>ریفرلز: <span id="userReferrals">0</span></p>
            </div>
        </div>
        <div class="section earnings-display">
            <h2>آپ کی کل کمائی: <span id="earnings">0 روپے</span></h2>
        </div>
        <div class="section admin-message" id="adminMessageSection">
            <h2>ایڈمن کا پیغام</h2>
            <p id="adminMessageText">یہاں ایڈمن کا تازہ ترین پیغام دکھائی دے گا۔</p>
            <button id="likeButton" onclick="likeMessage()">لائک کریں</button>
            <span id="likeCount">0</span>
        </div>
        <div class="section tasks" id="tasksSection">
            <h2>ٹاسکس مکمل کریں</h2>
            <p>ہر ویڈیو مکمل دیکھیں اور کمائیں!</p>
        </div>
        <div class="section referral-section">
            <h2>دوستوں کو مدعو کریں</h2>
            <p>ہر دوست کے سائن اپ پر 50 روپے بونس، 5% ان کی کمائی کا، اور 3% ان کے ریفرلز کی کمائی کا!</p>
            <input type="text" id="referralLink" readonly>
            <button onclick="copyReferralLink()">لنک کاپی کریں</button>
        </div>
        <div class="section rules" id="rulesSection">
            <h2>رولز</h2>
            <div id="rulesContent"></div>
        </div>
        <div class="section withdraw">
            <h2>کمائی واپس لیں</h2>
            <p>کم از کم 1000 روپے اور پہلے 3 ریفرلز درکار ہیں۔</p>
            <input type="text" id="withdrawNumber" placeholder="اپنا نمبر درج کریں" required>
            <select id="withdrawMethod">
                <option value="easypaisa">ایزی پیسہ</option>
                <option value="jazzcash">جیز کیش</option>
            </select>
            <button onclick="checkWithdrawal()">درخواست دیں</button>
            <p id="withdrawStatus"></p>
        </div>
        <div class="section withdraw-history">
            <h2>ودھ ڈراول ہسٹری</h2>
            <table id="withdrawHistoryTable">
                <tr><th>تاریخ</th><th>رقم</th><th>اکاؤنٹ/نمبر</th><th>سٹیٹس</th></tr>
            </table>
        </div>
        <div class="section complain-box">
            <h2>شکایت درج کریں</h2>
            <textarea id="complainText" rows="4" placeholder="اپنی شکایت یہاں لکھیں (روزانہ ایک بار)"></textarea>
            <button onclick="submitComplain()">جمع کریں</button>
            <p id="complainStatus"></p>
        </div>
    </div>

    <div class="auth-popup" id="adminLoginPopup">
        <h3>مین ایڈمن لاگ ان</h3>
        <input type="password" id="adminPassword" placeholder="ایڈمن پاس ورڈ" required>
        <button onclick="mainAdminLogin()">لاگ ان</button>
        <button onclick="hidePopup('adminLoginPopup')">بیک</button>
    </div>

    <div class="admin-section" id="adminSection">
        <div class="admin-header">
            <h2>مین ایڈمن روم</h2>
            <p>ہر چیز پر مکمل کنٹرول!</p>
        </div>
        <div class="admin-container">
            <div class="admin-card">
                <h2>روزانہ پیغام</h2>
                <textarea id="adminMessageInput" rows="4" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ffd700;" placeholder="یہاں اپنا پیغام لکھیں..."></textarea>
                <button class="control-btn" onclick="updateAdminMessage()">پیغام اپ ڈیٹ کریں</button>
            </div>
            <div class="admin-card">
                <h2>پرانی پوسٹس</h2>
                <div id="oldPosts"></div>
            </div>
            <div class="admin-card">
                <h2 onclick="toggleUserList()">صارفین کا انتظام</h2>
                <input type="text" class="search-bar" id="userSearch" placeholder="یوزر آئی ڈی سرچ کریں" onkeyup="searchUser()">
                <div class="user-list" id="userList"></div>
            </div>
            <div class="admin-card">
                <h2>ودھ ڈراول درخواستیں</h2>
                <table id="withdrawalsTable">
                    <tr><th>نام</th><th>رقم</th><th>نمبر</th><th>طریقہ</th><th>حالت</th><th>کنٹرول</th></tr>
                </table>
            </div>
            <div class="admin-card">
                <h2>ویڈیو لنکس اور قیمت تبدیل کریں</h2>
                <input type="number" class="control-input" id="videoIndex" placeholder="ویڈیو نمبر" min="1" required>
                <input type="text" class="control-input" id="newVideoLink" placeholder="نیا لنک (خالی چھوڑیں اگر صرف قیمت تبدیل کرنی ہو)">
                <input type="number" class="control-input" id="videoPrice" placeholder="نئی قیمت (روپے)" min="1">
                <button class="control-btn" onclick="changeVideoLink()">تبدیل کریں</button>
            </div>
            <div class="admin-card">
                <h2>رولز تبدیل کریں</h2>
                <textarea id="rulesInput" rows="4" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #ffd700;" placeholder="نئے رولز لکھیں..."></textarea>
                <button class="control-btn" onclick="updateRules()">رولز اپ ڈیٹ کریں</button>
            </div>
            <div class="admin-card">
                <h2>شکایات</h2>
                <div id="complainsList"></div>
            </div>
        </div>
        <div class="control-panel">
            <button class="back-btn" onclick="goBack()">بیک</button>
            <button class="logout-btn" onclick="logout()">لاگ آؤٹ</button>
        </div>
    </div>

    <script>
        // ڈیٹا انیشلائزیشن
        const mainAdminPassword = "MohammadOwaisAdmin2025!@#$ecure"; // سرور پر منتقل کرنے کی تجویز
        let users = JSON.parse(localStorage.getItem("users")) || {};
        let withdrawals = JSON.parse(localStorage.getItem("withdrawals")) || [];
        let withdrawHistory = JSON.parse(localStorage.getItem("withdrawHistory")) || {};
        let adminMessage = localStorage.getItem("adminMessage") || "خوش آمدید! اپنی کمائی شروع کریں۔";
        let rules = JSON.parse(localStorage.getItem("rules")) || [
            "ہر ویڈیو مکمل دیکھیں ورنہ کمائی نہیں ملے گی۔",
            "دھوکہ دہی پر اکاؤنٹ فوری معطل ہوگا۔",
            "صحیح معلومات درج کریں تاکہ ودھ ڈراول میں تاخیر نہ ہو۔"
        ];
        let videoLinks = JSON.parse(localStorage.getItem("videoLinks")) || [
            { link: "https://www.youtube.com/watch?v=dQw4w9WgXcQ", price: 10 },
            { link: "https://www.youtube.com/watch?v=3tmd-Claq34", price: 15 },
            { link: "https://www.youtube.com/watch?v=9bZkp7q19f0", price: 20 }
        ];
        let taskCooldowns = JSON.parse(localStorage.getItem("taskCooldowns")) || {};
        let likes = JSON.parse(localStorage.getItem("likes")) || { total: 0 };
        let oldPosts = JSON.parse(localStorage.getItem("oldPosts")) || [];
        let complains = JSON.parse(localStorage.getItem("complains")) || {};
        let currentUser = null;
        let isAdminLoggedIn = false;
        let tapCount = 0;
        let welcomeTapCount = 0;
        let players = {};

        // صفحہ لوڈ ہونے پر
        window.onload = function() {
            document.getElementById("welcomePage").style.display = "flex";
            checkReferralFromURL();
            loadRulesAndMessages();
            if (localStorage.getItem("currentUser")) {
                userLoginFromStorage();
            }
        };

        // ایڈمن لاگ ان کے لیے لوگو پر کلک
        document.getElementById('logo').addEventListener('click', function() {
            tapCount++;
            if (tapCount === 5) {
                showAdminLogin();
                tapCount = 0;
            }
        });

        document.getElementById('welcomeLogo').addEventListener('click', function() {
            welcomeTapCount++;
            if (welcomeTapCount === 5) {
                showAdminLogin();
                welcomeTapCount = 0;
            }
        });

        // بنیادی فنکشنز
        function showSignup() {
            document.getElementById("welcomePage").style.display = "none";
            document.getElementById("signupPopup").style.display = "block";
        }

        function showLogin() {
            document.getElementById("welcomePage").style.display = "none";
            document.getElementById("loginPopup").style.display = "block";
        }

        function hidePopup(id) {
            document.getElementById(id).style.display = "none";
            document.getElementById("welcomePage").style.display = "flex";
        }

        function userSignup() {
            const name = document.getElementById("signupName").value.trim();
            const password = document.getElementById("signupPassword").value.trim();
            if (!name || !password) {
                alert("براہ کرم نام اور پاس ورڈ درج کریں!");
                return;
            }
            if (users[name]) {
                alert("یہ نام پہلے سے موجود ہے!");
                return;
            }
            const userID = "UID" + Math.random().toString(36).substr(2, 9);
            const createdDate = new Date().toLocaleString();
            const referrer = new URLSearchParams(window.location.search).get("ref");
            users[name] = {
                password: password,
                earnings: 0,
                tasksCompleted: 0,
                number: "",
                referrals: 0,
                withdrawalCount: 0,
                userID: userID,
                createdDate: createdDate,
                referrer: referrer ? (users[referrer] ? referrer : null) : null,
                lastComplainDate: null
            };
            if (referrer && users[referrer]) {
                users[referrer].referrals += 1;
                users[referrer].earnings += 50;
                alert(`${referrer} کو 50 روپے بونس مل گیا!`);
            }
            localStorage.setItem("users", JSON.stringify(users));
            alert("اکاؤنٹ کامیابی سے بن گیا! اب لاگ ان کریں۔");
            hidePopup("signupPopup");
        }

        function userLogin() {
            const name = document.getElementById("loginName").value.trim();
            const password = document.getElementById("loginPassword").value.trim();
            if (users[name] && users[name].password === password) {
                currentUser = name;
                localStorage.setItem("currentUser", name);
                isAdminLoggedIn = false;
                loadUserData();
                document.getElementById("loginPopup").style.display = "none";
                document.getElementById("mainContent").style.display = "block";
                document.getElementById("adminSection").style.display = "none";
            } else {
                alert("غلط نام یا پاس ورڈ!");
            }
        }

        function userLoginFromStorage() {
            const name = localStorage.getItem("currentUser");
            if (users[name]) {
                currentUser = name;
                loadUserData();
                document.getElementById("welcomePage").style.display = "none";
                document.getElementById("mainContent").style.display = "block";
            }
        }

        function loadUserData() {
            if (!currentUser) return;
            const user = users[currentUser];
            document.getElementById("earnings").innerText = user.earnings + " روپے";
            document.getElementById("profileName").innerText = currentUser;
            document.getElementById("userName").innerText = currentUser;
            document.getElementById("userID").innerText = user.userID;
            document.getElementById("accountDate").innerText = user.createdDate;
            document.getElementById("userReferrals").innerText = user.referrals;
            document.getElementById("referralLink").value = `${window.location.origin}/?ref=${user.userID}`;
            loadTasks();
            loadWithdrawHistory();
            loadRulesAndMessages();
        }

        function toggleProfile() {
            const details = document.getElementById("profileDetails");
            details.style.display = details.style.display === "block" ? "none" : "block";
        }

        function loadTasks() {
            const tasksSection = document.getElementById("tasksSection");
            tasksSection.innerHTML = `
                <h2>ٹاسکس مکمل کریں</h2>
                <p>ہر ویڈیو مکمل دیکھیں اور کمائیں!</p>
            `;
            videoLinks.forEach((video, i) => {
                const task = document.createElement("div");
                task.className = "task";
                task.innerHTML = `
                    <p>ویڈیو ${i + 1}: <a href="${video.link}" target="_blank" onclick="startVideo('${i}')">ویڈیو دیکھیں</a> (${video.price} روپے)</p>
                    <button id="complete-btn-${i}" onclick="addEarnings(${video.price}, this, ${i})" disabled>مکمل کیا</button>
                    <span class="cooldown" id="cooldown-${i}"></span>
                `;
                tasksSection.appendChild(task);
            });
            if (currentUser) updateCooldowns();
        }

        function startVideo(videoIndex) {
            if (!currentUser) {
                alert("براہ کرم پہلے لاگ ان کریں!");
                return;
            }
            const videoId = videoLinks[videoIndex].link.split("v=")[1].split("&")[0];
            const playerDiv = document.createElement("div");
            playerDiv.id = `player-${videoIndex}`;
            playerDiv.style.display = "none"; // ویڈیو پلیئر چھپائیں
            document.body.appendChild(playerDiv);
            players[videoIndex] = new YT.Player(`player-${videoIndex}`, {
                height: '1',
                width: '1',
                videoId: videoId,
                playerVars: { 'autoplay': 1, 'controls': 0, 'rel': 0 },
                events: {
                    'onStateChange': (event) => onPlayerStateChange(event, videoIndex),
                    'onError': (event) => alert("ویڈیو میں خرابی: " + event.data)
                }
            });
        }

        function onPlayerStateChange(event, videoIndex) {
            if (event.data === YT.PlayerState.ENDED && currentUser) {
                document.getElementById(`complete-btn-${videoIndex}`).disabled = false;
                document.body.removeChild(document.getElementById(`player-${videoIndex}`));
                delete players[videoIndex];
            }
        }

        function addEarnings(amount, button, videoIndex) {
            if (!currentUser) return;
            const user = users[currentUser];
            user.earnings += amount;
            if (user.referrer) {
                const referrer = users[user.referrer];
                referrer.earnings += amount * 0.05; // 5% بونس
                if (referrer.referrer) {
                    users[referrer.referrer].earnings += amount * 0.03; // 3% بونس
                }
            }
            user.tasksCompleted += 1;
            document.getElementById("earnings").innerText = user.earnings + " روپے";
            button.disabled = true;
            button.innerText = "مکمل ہو گیا";
            if (!taskCooldowns[currentUser]) taskCooldowns[currentUser] = {};
            taskCooldowns[currentUser][videoIndex] = Date.now();
            localStorage.setItem("users", JSON.stringify(users));
            localStorage.setItem("taskCooldowns", JSON.stringify(taskCooldowns));
            alert(`مبارک ہو! آپ نے ${amount} روپے کمائے۔`);
            updateCooldowns();
        }

        function updateCooldowns() {
            if (!currentUser) return;
            videoLinks.forEach((_, i) => {
                const cooldownElement = document.getElementById(`cooldown-${i}`);
                const lastTaskTime = taskCooldowns[currentUser]?.[i] || 0;
                const currentTime = Date.now();
                const remaining = 30 * 60 * 1000 - (currentTime - lastTaskTime);
                if (remaining > 0) {
                    const minutes = Math.ceil(remaining / 1000 / 60);
                    cooldownElement.innerText = `دوبارہ کوشش: ${minutes} منٹ`;
                    setTimeout(updateCooldowns, 60000);
                } else {
                    cooldownElement.innerText = "";
                    const button = document.getElementById(`complete-btn-${i}`);
                    if (button && button.innerText === "مکمل ہو گیا") {
                        button.disabled = true; // کول ڈاؤن ختم ہونے کے بعد بھی دوبارہ فعال نہیں ہوگا جب تک نئی ویڈیو نہ دیکھی جائے
                    }
                }
            });
        }

        function checkWithdrawal() {
            if (!currentUser) return;
            const user = users[currentUser];
            const number = document.getElementById("withdrawNumber").value.trim();
            const method = document.getElementById("withdrawMethod").value;
            if (user.earnings < 1000) {
                alert("کم از کم 1000 روپے کمائیں!");
                return;
            }
            if (user.withdrawalCount === 0 && user.referrals < 3) {
                alert("پہلی ودھ ڈراول کے لیے 3 ریفرلز درکار ہیں!");
                return;
            }
            if (!number.match(/^\d{11}$/)) {
                alert("براہ کرم درست 11 ہندسوں کا نمبر درج کریں!");
                return;
            }
            const amount = user.earnings;
            withdrawals.push({ user: currentUser, number, amount, method, status: "processing", date: new Date().toLocaleString() });
            user.number = number;
            if (!withdrawHistory[currentUser]) withdrawHistory[currentUser] = [];
            withdrawHistory[currentUser].push({ date: new Date().toLocaleString(), amount, number, status: "processing" });
            localStorage.setItem("withdrawals", JSON.stringify(withdrawals));
            localStorage.setItem("withdrawHistory", JSON.stringify(withdrawHistory));
            alert("ودھ ڈراول درخواست موصول ہوئی!");
            loadWithdrawHistory();
            document.getElementById("withdrawStatus").innerText = "پروسیسنگ میں ہے...";
            document.getElementById("withdrawNumber").value = "";
        }

        function loadWithdrawHistory() {
            if (!currentUser) return;
            const table = document.getElementById("withdrawHistoryTable");
            table.innerHTML = "<tr><th>تاریخ</th><th>رقم</th><th>اکاؤنٹ/نمبر</th><th>سٹیٹس</th></tr>";
            if (withdrawHistory[currentUser]) {
                withdrawHistory[currentUser].forEach(w => {
                    const row = table.insertRow();
                    row.innerHTML = `<td>${w.date}</td><td>${w.amount} روپے</td><td>${w.number}</td><td>${w.status === "processing" ? "پروسیسنگ" : "مکمل"}</td>`;
                });
            }
        }

        function copyReferralLink() {
            if (!currentUser) return;
            const link = document.getElementById("referralLink");
            link.select();
            document.execCommand("copy");
            alert("ریفرل لنک کاپی ہو گیا!");
        }

        function checkReferralFromURL() {
            const referrer = new URLSearchParams(window.location.search).get("ref");
            if (referrer && !currentUser) {
                alert(`آپ کو ${referrer} نے مدعو کیا! سائن اپ کے بعد انہیں 50 روپے بونس ملے گا۔`);
            }
        }

        function submitComplain() {
            if (!currentUser) return;
            const user = users[currentUser];
            const complainText = document.getElementById("complainText").value.trim();
            const today = new Date().toDateString();
            if (!complainText) {
                alert("براہ کرم شکایت لکھیں!");
                return;
            }
            if (user.lastComplainDate === today) {
                alert("آپ روزانہ صرف ایک شکایت درج کر سکتے ہیں!");
                return;
            }
            if (!complains[currentUser]) complains[currentUser] = [];
            complains[currentUser].push({ text: complainText, date: new Date().toLocaleString() });
            user.lastComplainDate = today;
            localStorage.setItem("complains", JSON.stringify(complains));
            localStorage.setItem("users", JSON.stringify(users));
            document.getElementById("complainText").value = "";
            document.getElementById("complainStatus").innerText = "شکایت درج ہو گئی!";
            setTimeout(() => document.getElementById("complainStatus").innerText = "", 3000);
        }

        function showAdminLogin() {
            document.getElementById("adminLoginPopup").style.display = "block";
        }

        function mainAdminLogin() {
            const password = document.getElementById("adminPassword").value.trim();
            if (password === mainAdminPassword) {
                isAdminLoggedIn = true;
                document.getElementById("adminLoginPopup").style.display = "none";
                document.getElementById("adminSection").style.display = "block";
                document.getElementById("mainContent").style.display = "none";
                document.getElementById("welcomePage").style.display = "none";
                loadMainAdminData();
            } else {
                alert("غلط ایڈمن پاس ورڈ!");
            }
        }

        function updateAdminMessage() {
            const message = document.getElementById("adminMessageInput").value.trim();
            if (!message) {
                alert("براہ کرم پیغام درج کریں!");
                return;
            }
            const oldPost = { message: adminMessage, likes: likes.total || 0, date: new Date().toLocaleString() };
            oldPosts.unshift(oldPost);
            if (oldPosts.length > 5) oldPosts.pop();
            localStorage.setItem("oldPosts", JSON.stringify(oldPosts));
            adminMessage = message;
            likes = { total: 0 };
            localStorage.setItem("adminMessage", adminMessage);
            localStorage.setItem("likes", JSON.stringify(likes));
            document.getElementById("adminMessageText").innerText = adminMessage;
            document.getElementById("likeCount").innerText = 0;
            document.getElementById("likeButton").disabled = false;
            alert("پیغام اپ ڈیٹ ہو گیا!");
            loadOldPosts();
        }

        function likeMessage() {
            if (!currentUser) {
                alert("براہ کرم لاگ ان کریں!");
                return;
            }
            if (likes[currentUser]) {
                alert("آپ پہلے ہی لائک کر چکے ہیں!");
                return;
            }
            likes.total = (likes.total || 0) + 1;
            likes[currentUser] = true;
            document.getElementById("likeCount").innerText = likes.total;
            document.getElementById("likeButton").disabled = true;
            localStorage.setItem("likes", JSON.stringify(likes));
            alert("پیغام لائک ہو گیا!");
        }

        function loadOldPosts() {
            const oldPostsDiv = document.getElementById("oldPosts");
            oldPostsDiv.innerHTML = "";
            if (oldPosts.length > 0) {
                const dot = document.createElement("div");
                dot.style.width = "10px";
                dot.style.height = "10px";
                dot.style.background = "#ccc";
                dot.style.borderRadius = "50%";
                dot.style.cursor = "pointer";
                dot.onclick = showOldPosts;
                oldPostsDiv.appendChild(dot);
            }
        }

        function showOldPosts() {
            const oldPostsDiv = document.getElementById("oldPosts");
            oldPostsDiv.innerHTML = "";
            oldPosts.forEach((post) => {
                const postDiv = document.createElement("div");
                postDiv.innerHTML = `<p>${post.message} (تاریخ: ${post.date}) - لائکس: ${post.likes}</p>`;
                oldPostsDiv.appendChild(postDiv);
            });
        }

        function loadMainAdminData() {
            document.getElementById("adminMessageInput").value = adminMessage;
            document.getElementById("rulesInput").value = rules.join("\n");
            loadUserList();
            loadComplains();
            const withdrawalsTable = document.getElementById("withdrawalsTable");
            withdrawalsTable.innerHTML = "<tr><th>نام</th><th>رقم</th><th>نمبر</th><th>طریقہ</th><th>حالت</th><th>کنٹرول</th></tr>";
            withdrawals.forEach((w, i) => {
                const row = withdrawalsTable.insertRow();
                row.innerHTML = `
                    <td>${w.user}</td>
                    <td>${w.amount} روپے</td>
                    <td>${w.number}</td>
                    <td>${w.method}</td>
                    <td>${w.status === "processing" ? "پروسیسنگ" : "مکمل"}</td>
                    <td>
                        <button class="control-btn" onclick="approveWithdrawal(${i})" ${w.status === "complete" ? "disabled" : ""}>منظور</button>
                        <button class="control-btn suspend-btn" onclick="rejectWithdrawal(${i})" ${w.status === "complete" ? "disabled" : ""}>مسترد</button>
                    </td>
                `;
            });
        }

        function loadUserList() {
            const userList = document.getElementById("userList");
            userList.innerHTML = "";
            for (let user in users) {
                const u = users[user];
                const userDiv = document.createElement("p");
                userDiv.innerHTML = `${user} - ${u.earnings} روپے - ${u.referrals} ریفرلز - ${u.userID}
                    <button class="control-btn" onclick="payUser('${user}')">ادائیگی</button>
                    <button class="control-btn suspend-btn" onclick="deleteAccount('${user}')">ڈیلیٹ</button>`;
                userList.appendChild(userDiv);
            }
        }

        function toggleUserList() {
            const userList = document.getElementById("userList");
            userList.style.display = userList.style.display === "block" ? "none" : "block";
        }

        function searchUser() {
            const searchValue = document.getElementById("userSearch").value.trim().toLowerCase();
            const userList = document.getElementById("userList");
            userList.innerHTML = "";
            for (let user in users) {
                if (users[user].userID.toLowerCase().includes(searchValue) || user.toLowerCase().includes(searchValue)) {
                    const u = users[user];
                    const userDiv = document.createElement("p");
                    userDiv.innerHTML = `${user} - ${u.earnings} روپے - ${u.referrals} ریفرلز - ${u.userID}
                        <button class="control-btn" onclick="payUser('${user}')">ادائیگی</button>
                        <button class="control-btn suspend-btn" onclick="deleteAccount('${user}')">ڈیلیٹ</button>`;
                    userList.appendChild(userDiv);
                }
            }
        }

        function payUser(user) {
            if (confirm(`${user} کو ${users[user].earnings} روپے ادائیگی کرنا چاہتے ہیں؟`)) {
                users[user].earnings = 0;
                localStorage.setItem("users", JSON.stringify(users));
                loadMainAdminData();
                if (currentUser === user) loadUserData();
                alert(`${user} کو ادائیگی کامیاب ہوئی۔`);
            }
        }

        function deleteAccount(user) {
            if (confirm(`${user} کا اکاؤنٹ ڈیلیٹ کرنا چاہتے ہیں؟`)) {
                if (currentUser === user) {
                    currentUser = null;
                    localStorage.removeItem("currentUser");
                }
                delete users[user];
                delete withdrawHistory[user];
                delete complains[user];
                localStorage.setItem("users", JSON.stringify(users));
                localStorage.setItem("withdrawHistory", JSON.stringify(withdrawHistory));
                localStorage.setItem("complains", JSON.stringify(complains));
                loadMainAdminData();
                alert(`${user} کا اکاؤنٹ ڈیلیٹ ہو گیا۔`);
            }
        }

        function approveWithdrawal(index) {
            const w = withdrawals[index];
            const user = users[w.user];
            user.earnings -= w.amount;
            user.withdrawalCount += 1;
            if (user.referrer) users[user.referrer].earnings += w.amount * 0.05;
            w.status = "complete";
            withdrawHistory[w.user].find(h => h.date === w.date).status = "complete";
            localStorage.setItem("users", JSON.stringify(users));
            localStorage.setItem("withdrawals", JSON.stringify(withdrawals));
            localStorage.setItem("withdrawHistory", JSON.stringify(withdrawHistory));
            loadMainAdminData();
            if (currentUser === w.user) {
                loadUserData();
                document.getElementById("withdrawStatus").innerText = "ادائیگی مکمل ہو گئی!";
                setTimeout(() => document.getElementById("withdrawStatus").innerText = "", 3000);
            }
            alert(`ادائیگی ${w.number} کو بھیج دی گئی۔`);
        }

        function rejectWithdrawal(index) {
            const w = withdrawals[index];
            withdrawals.splice(index, 1);
            withdrawHistory[w.user] = withdrawHistory[w.user].filter(h => h.date !== w.date);
            localStorage.setItem("withdrawals", JSON.stringify(withdrawals));
            localStorage.setItem("withdrawHistory", JSON.stringify(withdrawHistory));
            loadMainAdminData();
            if (currentUser === w.user) {
                loadUserData();
                document.getElementById("withdrawStatus").innerText = "درخواست مسترد ہو گئی!";
                setTimeout(() => document.getElementById("withdrawStatus").innerText = "", 3000);
            }
            alert("درخواست مسترد ہو گئی۔");
        }

        function changeVideoLink() {
            const index = parseInt(document.getElementById("videoIndex").value) - 1;
            const newLink = document.getElementById("newVideoLink").value.trim();
            const newPrice = parseInt(document.getElementById("videoPrice").value) || videoLinks[index]?.price;
            if (isNaN(index) || index < 0) {
                alert("براہ کرم درست ویڈیو نمبر درج کریں!");
                return;
            }
            if (newLink && !newLink.includes("youtube.com/watch?v=")) {
                alert("براہ کرم درست YouTube لنک درج کریں!");
                return;
            }
            if (newLink) {
                if (index < videoLinks.length) {
                    videoLinks[index].link = newLink;
                } else {
                    videoLinks.push({ link: newLink, price: newPrice || 10 });
                }
            }
            if (newPrice && index < videoLinks.length) {
                videoLinks[index].price = newPrice;
            }
            localStorage.setItem("videoLinks", JSON.stringify(videoLinks));
            loadTasks();
            alert(`ویڈیو ${index + 1} تبدیل ہو گئی: ${newLink || videoLinks[index].link} (${videoLinks[index].price} روپے)`);
            document.getElementById("videoIndex").value = "";
            document.getElementById("newVideoLink").value = "";
            document.getElementById("videoPrice").value = "";
        }

        function updateRules() {
            const newRules = document.getElementById("rulesInput").value.trim().split("\n").filter(rule => rule.trim());
            if (newRules.length === 0) {
                alert("براہ کرم کم از کم ایک رول درج کریں!");
                return;
            }
            rules = newRules;
            localStorage.setItem("rules", JSON.stringify(rules));
            loadRulesAndMessages();
            alert("رولز اپ ڈیٹ ہو گئے!");
        }

        function loadRulesAndMessages() {
            document.getElementById("adminMessageText").innerText = adminMessage;
            document.getElementById("likeCount").innerText = likes.total || 0;
            document.getElementById("likeButton").disabled = currentUser && likes[currentUser] ? true : false;
            const rulesContent = document.getElementById("rulesContent");
            rulesContent.innerHTML = "";
            rules.forEach(rule => {
                const p = document.createElement("p");
                p.innerText = rule;
                rulesContent.appendChild(p);
            });
        }

        function loadComplains() {
            const complainsList = document.getElementById("complainsList");
            complainsList.innerHTML = "";
            for (let user in complains) {
                complains[user].forEach(c => {
                    const p = document.createElement("p");
                    p.innerHTML = `${user}: ${c.text} (تاریخ: ${c.date})`;
                    complainsList.appendChild(p);
                });
            }
        }

        function logout() {
            isAdminLoggedIn = false;
            currentUser = null;
            localStorage.removeItem("currentUser");
            document.getElementById("adminSection").style.display = "none";
            document.getElementById("mainContent").style.display = "none";
            document.getElementById("welcomePage").style.display = "flex";
        }

        function goBack() {
            if (isAdminLoggedIn) {
                document.getElementById("adminSection").style.display = "none";
                if (currentUser) {
                    document.getElementById("mainContent").style.display = "block";
                    loadUserData();
                } else {
                    document.getElementById("welcomePage").style.display = "flex";
                }
            }
        }
    </script>
</body>
</html>